<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Construction Estimator</title>
  <link rel="stylesheet" href="style.css">
  <script>window.__CE_ALLOW_PERSISTENCE = true;</script>
  <script type="module" src="app.js" defer></script>
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div>
        <p class="eyebrow">Construction Estimator</p>
        <h1 class="app-title">Project cost planning in minutes</h1>
      </div>
      <div class="header-actions">
        <button class="ghost" id="undoAction" type="button" aria-label="Undo last action" disabled>Undo</button>
        <button class="ghost" id="redoAction" type="button" aria-label="Redo last action" disabled>Redo</button>
      </div>
    </header>

    <nav class="tab-nav" aria-label="Primary">
      <button type="button" class="tab-link is-active" data-tab="dashboard">Dashboard</button>
      <button type="button" class="tab-link" data-tab="estimator">Quick estimate</button>
      <button type="button" class="tab-link" data-tab="projects">Projects</button>
      <button type="button" class="tab-link" data-tab="materials">Materials</button>
      <button type="button" class="tab-link" data-tab="settings">Settings</button>
    </nav>

    <main class="tab-content">
      <section id="dashboard" class="panel is-active" aria-labelledby="tab-dashboard">
        <div class="grid grid--metrics" role="list">
          <article class="metric" role="listitem">
            <p class="metric__label">Total projects</p>
            <p class="metric__value" id="metricTotalProjects">0</p>
          </article>
          <article class="metric" role="listitem">
            <p class="metric__label">Pipeline value</p>
            <p class="metric__value" id="metricTotalValue">$0</p>
          </article>
          <article class="metric" role="listitem">
            <p class="metric__label">Under review</p>
            <p class="metric__value" id="metricReviewCount">0</p>
          </article>
          <article class="metric" role="listitem">
            <p class="metric__label">Win rate</p>
            <p class="metric__value" id="metricWinRate">0%</p>
          </article>
        </div>

        <section class="card">
          <div class="card__header">
            <h2 class="card__title">Recent activity</h2>
            <button class="ghost" type="button" id="newProjectFromDashboard">New project</button>
          </div>
          <div id="recentProjects" class="timeline" aria-live="polite"></div>
        </section>

        <section class="card">
          <h2 class="card__title">Company snapshot</h2>
          <dl class="definition-list" id="companySnapshot"></dl>
        </section>
      </section>

      <section id="estimator" class="panel" aria-labelledby="tab-estimator">
        <div class="split">
          <form id="estimateForm" class="stack" novalidate>
            <fieldset class="card stack">
              <legend class="card__title">Project details</legend>
              <label class="field">
                <span class="field__label">Project name</span>
                <input type="text" name="projectName" required placeholder="Example: Riverside Lofts">
              </label>
              <label class="field">
                <span class="field__label">Type</span>
                <select name="projectType" required>
                  <option value="">Select type</option>
                  <option value="residential">Residential</option>
                  <option value="commercial">Commercial</option>
                  <option value="industrial">Industrial</option>
                  <option value="renovation">Renovation</option>
                </select>
              </label>
              <div class="field-group">
                <label class="field">
                  <span class="field__label">Square footage</span>
                  <input type="number" name="sqft" min="0" step="1" required>
                </label>
                <label class="field">
                  <span class="field__label">Floors</span>
                  <input type="number" name="floors" min="1" step="1" value="1" required>
                </label>
                <label class="field">
                  <span class="field__label">Labor multiplier</span>
                  <input type="number" name="laborMultiplier" min="1" step="0.1" value="1.4" required>
                </label>
              </div>
            </fieldset>

            <fieldset class="card stack" id="materialSelectors">
              <legend class="card__title">Material selections</legend>
              <!-- Material selectors inserted by script -->
            </fieldset>

            <button class="primary" type="submit">Generate estimate</button>
          </form>

          <aside class="card stack" id="estimateSummary" aria-live="polite">
            <h2 class="card__title">Estimate summary</h2>
            <p class="muted" id="estimateHint">Fill in the form to see totals.</p>
            <div id="estimateBreakdown" hidden>
              <dl class="definition-list" id="estimateDetails"></dl>
              <div class="total">
                <span>Total</span>
                <strong id="estimateTotal">$0</strong>
              </div>
              <button class="secondary" type="button" id="saveEstimate" disabled>Save as project</button>
            </div>
          </aside>
        </div>
      </section>

      <section id="projects" class="panel" aria-labelledby="tab-projects">
        <div class="card stack">
          <div class="card__header">
            <h2 class="card__title">Projects</h2>
            <div class="card__actions">
              <button class="ghost" type="button" id="filterDrafts">Show drafts</button>
              <button class="ghost" type="button" id="clearFilters">Clear filters</button>
            </div>
          </div>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th scope="col">Name</th>
                  <th scope="col">Type</th>
                  <th scope="col">Status</th>
                  <th scope="col">Value</th>
                  <th scope="col">Updated</th>
                  <th scope="col" class="text-right">Actions</th>
                </tr>
              </thead>
              <tbody id="projectsTable"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section id="materials" class="panel" aria-labelledby="tab-materials">
        <div class="card stack">
          <h2 class="card__title">Material catalogue</h2>
          <div id="materialsList" class="materials" aria-live="polite"></div>
        </div>
      </section>

      <section id="settings" class="panel" aria-labelledby="tab-settings">
        <form id="settingsForm" class="card stack" novalidate>
          <h2 class="card__title">Company profile</h2>
          <label class="field">
            <span class="field__label">Company name</span>
            <input type="text" name="company" placeholder="Northwind Builders">
          </label>
          <label class="field">
            <span class="field__label">Address</span>
            <input type="text" name="address" placeholder="123 Market Street">
          </label>
          <label class="field">
            <span class="field__label">Phone</span>
            <input type="tel" name="phone" placeholder="(555) 123-4567">
          </label>
          <label class="field">
            <span class="field__label">Email</span>
            <input type="email" name="email" placeholder="estimating@example.com">
          </label>
          <button class="primary" type="submit">Save profile</button>
        </form>
      </section>
    </main>

    <div class="toast-region" aria-live="assertive" aria-atomic="true"></div>
  </div>
</body>
</html>
